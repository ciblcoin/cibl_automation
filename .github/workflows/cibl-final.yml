name: CIBL Professional Promotion

on:
  workflow_dispatch:
    inputs:
      post_type:
        description: 'Select promotion type'
        required: true
        default: 'airdrop'
        type: choice
        options:
          - airdrop
          - price_chart
          - community
          - social_media

env:
  # Ø¢ÛŒØ¯ÛŒ Ú©Ø§Ù†Ø§Ù„ @CIBLOfficial (Ù…Ù†ÙÛŒ)
  CHANNEL_ID: "-1002923296515"
  CONTRACT: "2Lpgt5teMe4SPp1G8x1URBk6dPRoimftdANmAsFDvkPA"
  IMAGE_URL: "https://raw.githubusercontent.com/ciblcoin/app/main/public/videos/image1.png"
  CURRENT_PRICE: "0.000000008873"

jobs:
  send-promotion:
    runs-on: ubuntu-latest
    
    steps:
      - name: Get Live Market Data
        id: market_data
        run: |
          echo "Fetching live CIBL price data..."
          
          response=$(curl -s "https://api.dexscreener.com/latest/dex/tokens/$CONTRACT")
          price=$(echo $response | jq -r '.pairs[0].priceUsd // "'"$CURRENT_PRICE"'"')
          change=$(echo $response | jq -r '.pairs[0].priceChange.h24 // "0.00"')
          
          # ÙØ±Ù…Øª Ù‚ÛŒÙ…Øª
          formatted_price="\$$price"
          
          # ÙØ±Ù…Øª ØªØºÛŒÛŒØ±Ø§Øª Ø¨Ø§ emoji
          if (( $(echo "$change >= 0" | bc -l 2>/dev/null) )); then
            formatted_change="ğŸŸ¢ +$change%"
          else
            formatted_change="ğŸ”´ $change%"
          fi
          
          echo "price=$formatted_price" >> $GITHUB_OUTPUT
          echo "change=$formatted_change" >> $GITHUB_OUTPUT
          echo "chart_url=https://dexscreener.com/solana/$CONTRACT" >> $GITHUB_OUTPUT
          
          echo "âœ… Live data: $formatted_price | $formatted_change"

      - name: Send Airdrop Promotion with Image
        if: github.event.inputs.post_type == 'airdrop'
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "chat_id": "-1002923296515",
              "photo": "'"$IMAGE_URL"'",
              "caption": "<b>ğŸš€ CIBL MEGA AIRDROP - LIVE NOW! ğŸš€</b>\n\n<i>The Biggest Airdrop Event on Solana Network!</i>\n\n<b>ğŸ“ Contract Address:</b>\n<code>2Lpgt5teMe4SPp1G8x1URBk6dPRoimftdANmAsFDvkPA</code>\n\n<b>ğŸ’° Current Price:</b> '"${{ steps.market_data.outputs.price }}"'\n<b>ğŸ“ˆ 24h Change:</b> '"${{ steps.market_data.outputs.change }}"'\n\n<b>ğŸ¯ Why Choose CIBL?</b>\nâœ… <b>Massive Airdrop Rewards</b> â€“ Earn free tokens\nâœ… <b>Strong Community</b> â€“ 5,000+ holders & growing\nâœ… <b>Solana Speed</b> â€“ Lightning fast, low fees\nâœ… <b>Transparent Team</b> â€“ Fully doxxed & committed\nâœ… <b>Innovative Tokenomics</b> â€“ Sustainable growth\nâœ… <b>Huge Potential</b> â€“ Early stage opportunity\n\n<b>ğŸ”¥ Limited Time Opportunity!</b>\nEarly participants receive bonus rewards!\n\n<b>â° Don'\''t Wait - Join Now!</b>\n\n#CIBL #Solana #Airdrop #Crypto #DeFi #Memecoin #Blockchain",
              "parse_mode": "HTML",
              "reply_markup": {
                "inline_keyboard": [[
                  {"text": "ğŸŒ Website", "url": "https://ciblcoin.com"},
                  {"text": "ğŸ Airdrop", "url": "https://cbl.ag"}
                ]]
              }
            }' \
            https://api.telegram.org/bot$BOT_TOKEN/sendPhoto

      - name: Send Price Chart Promotion
        if: github.event.inputs.post_type == 'price_chart'
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "chat_id": "-1002923296515",
              "photo": "'"$IMAGE_URL"'",
              "caption": "<b>ğŸ“ˆ CIBL PRICE UPDATE â€“ TRENDING ON SOLANA! ğŸ“ˆ</b>\n\n<i>âš¡ Major Price Movement Detected â€“ Don'\''t Miss Out! âš¡</i>\n\n<b>ğŸ’° Live Price:</b> '"${{ steps.market_data.outputs.price }}"'\n<b>ğŸ“Š 24h Change:</b> '"${{ steps.market_data.outputs.change }}"'\n\n<b>ğŸ“ Contract Address:</b>\n<code>2Lpgt5teMe4SPp1G8x1URBk6dPRoimftdANmAsFDvkPA</code>\n\n<b>ğŸš€ Why CIBL Is Moving?</b>\nğŸ“Š Strong fundamentals and growing adoption\nğŸš€ Increasing trading volume and liquidity\nğŸ‘¥ Rapid community expansion\nğŸ¯ Strategic partnerships in development\nğŸ”¥ Positive market sentiment and momentum\n\n<b>ğŸ¯ Key Features:</b>\nâœ… High-performance Solana token\nâœ… Active development team\nâœ… Regular updates and improvements\nâœ… Community-driven decisions\nâœ… Transparent roadmap\n\n<b>ğŸ’ Investment Opportunity:</b>\nâ€¢ Early stage project with massive potential\nâ€¢ Limited token supply available\nâ€¢ Growing ecosystem integration\nâ€¢ Upcoming exchange listings\nâ€¢ Marketing campaigns underway\n\n<b>â° Act Now Before Next Pump!</b>\n\n#CIBL #Solana #Crypto #Trading #Investing #DeFi #Web3",
              "parse_mode": "HTML",
              "reply_markup": {
                "inline_keyboard": [[
                  {"text": "ğŸ“Š View Chart", "url": "'"${{ steps.market_data.outputs.chart_url }}"'"},
                  {"text": "ğŸŒ Website", "url": "https://ciblcoin.com"}
                ]]
              }
            }' \
            https://api.telegram.org/bot$BOT_TOKEN/sendPhoto

      - name: Send Community Promotion
        if: github.event.inputs.post_type == 'community'
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "chat_id": "-1002923296515",
              "photo": "'"$IMAGE_URL"'",
              "caption": "<b>ğŸ‘¥ JOIN 5,000+ CIBL HOLDERS COMMUNITY! ğŸ‘¥</b>\n\n<i>ğŸ’ª Strongest & Fastest Growing Community on Solana! ğŸ’ª</i>\n\n<b>ğŸ“ Contract Address:</b>\n<code>2Lpgt5teMe4SPp1G8x1URBk6dPRoimftdANmAsFDvkPA</code>\n\n<b>ğŸ’° Current Price:</b> '"${{ steps.market_data.outputs.price }}"'\n<b>ğŸ“ˆ 24h Change:</b> '"${{ steps.market_data.outputs.change }}"'\n\n<b>ğŸ¤ Community Benefits:</b>\nâœ… Active Telegram group with 24/7 discussions\nâœ… Regular AMA sessions with the team\nâœ… Exclusive community events and giveaways\nâœ… Early access to announcements and updates\nâœ… Voting rights on important decisions\nâœ… Supportive environment for all members\n\n<b>ğŸŒŸ Why Our Community Stands Out:</b>\nâœ¨ Genuine engagement and real conversations\nâœ¨ Helpful members always ready to assist\nâœ¨ Educational content for all experience levels\nâœ¨ Positive and encouraging atmosphere\nâœ¨ Strong sense of unity and common goals\n\n<b>ğŸš€ Community Growth:</b>\nğŸ“ˆ Rapidly expanding member base\nğŸ“ˆ Increasing social media presence\nğŸ“ˆ Growing influencer partnerships\nğŸ“ˆ Expanding global reach\nğŸ“ˆ Strengthening network effects\n\n<b>ğŸ”— Connect With Us Today!</b>\n\n#CIBL #Solana #Community #Crypto #DeFi #Blockchain #Web3",
              "parse_mode": "HTML",
              "reply_markup": {
                "inline_keyboard": [[
                  {"text": "ğŸ’¬ Join Chat", "url": "https://t.me/CIBLcoin"},
                  {"text": "ğŸ“¢ Channel", "url": "https://t.me/CIBLOfficial"}
                ]]
              }
            }' \
            https://api.telegram.org/bot$BOT_TOKEN/sendPhoto

      - name: Send Social Media Promotion
        if: github.event.inputs.post_type == 'social_media'
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -d '{
              "chat_id": "-1002923296515",
              "photo": "'"$IMAGE_URL"'",
              "caption": "<b>ğŸŒ CONNECT WITH CIBL ACROSS ALL PLATFORMS! ğŸŒ</b>\n\n<i>âœ¨ Join Our Growing Social Media Network! âœ¨</i>\n\n<b>ğŸ“ Contract Address:</b>\n<code>2Lpgt5teMe4SPp1G8x1URBk6dPRoimftdANmAsFDvkPA</code>\n\n<b>ğŸ’° Current Price:</b> '"${{ steps.market_data.outputs.price }}"'\n<b>ğŸ“ˆ 24h Change:</b> '"${{ steps.market_data.outputs.change }}"'\n\n<b>ğŸ¦ Twitter (X):</b>\nLatest announcements & market insights\n<b>Link:</b> https://x.com/CiblCrypto\n\n<b>ğŸ’¬ Telegram:</b>\nActive 24/7 community discussions\n<b>Link:</b> https://t.me/CIBLcoin\n\n<b>ğŸ“¸ Instagram:</b>\nVisual content & community highlights\n<b>Link:</b> https://www.instagram.com/ciblcoin\n\n<b>ğŸ® Discord:</b>\nAdvanced discussions & developer chats\n<b>Link:</b> https://discord.gg/9HeTsHJcTq\n\n<b>ğŸ“º YouTube:</b>\nTutorials, AMAs & educational content\n<b>Link:</b> https://www.youtube.com/@ciblcoin\n\n<b>ğŸ”— Stay Connected Everywhere!</b>\n\n#CIBL #Solana #SocialMedia #Community #Crypto #Network",
              "parse_mode": "HTML",
              "reply_markup": {
                "inline_keyboard": [[
                  {"text": "ğŸŒ Website", "url": "https://ciblcoin.com"},
                  {"text": "ğŸ Airdrop", "url": "https://cbl.ag"}
                ]]
              }
            }' \
            https://api.telegram.org/bot$BOT_TOKEN/sendPhoto

      - name: Notify Admin
        if: always()
        env:
          BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        run: |
          if [ -n "${{ secrets.ADMIN_CHAT_ID }}" ]; then
            curl -X POST \
              -H "Content-Type: application/json" \
              -d "{
                \"chat_id\": \"${{ secrets.ADMIN_CHAT_ID }}\",
                \"text\": \"âœ… CIBL promotion sent to channel!\\n\\nType: ${{ github.event.inputs.post_type }}\\nChannel: @CIBLOfficial (ID: -1002923296515)\\nImage: $IMAGE_URL\\nTime: $(date)\",
                \"parse_mode\": \"HTML\"
              }" \
              https://api.telegram.org/bot$BOT_TOKEN/sendMessage || true
          fi